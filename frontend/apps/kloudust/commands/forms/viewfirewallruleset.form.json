{
"id": "viewfirwallruleset",
"command": "tablelist",
"type": "table_display",

"i18n": {
"en": {
    "RULESET_direction": "Direction",
    "RULESET_allow": "Allow/Deny",
    "RULESET_protocol": "Protocol",
    "RULESET_ip": "IP",
    "RULESET_port": "Port"
},

"hi": {
    "RULESET_direction": "Direction",
    "RULESET_allow": "Allow/Deny",
    "RULESET_protocol": "Protocol",
    "RULESET_ip": "IP",
    "RULESET_port": "Port"
},

"ja": {
    "RULESET_direction": "Direction",
    "RULESET_allow": "Allow/Deny",
    "RULESET_protocol": "Protocol",
    "RULESET_ip": "IP",
    "RULESET_port": "Port"
},

"zh": {
    "RULESET_direction": "Direction",
    "RULESET_allow": "Allow/Deny",
    "RULESET_protocol": "Protocol",
    "RULESET_ip": "IP",
    "RULESET_port": "Port"
}
},

"tabledef": {
    "popupform": {
    "rolelist": {
        "*":[]
    }
    },

    "style": "div#tablebottombar{display: none;}",

    "i18nPrefix": "RULESET",

    "onclickrow_html": [
        "<style>div#onclick_html {background-color: #F8F8F8; width: auto;} div#close{display: none !important}</style>",
        "<style>div#onclickrow_html {height: fit-content;} div#body{background-color: #F8F8F8 !important}</style>",
        "<style>div#buttons {margin: 0 !important; align-items: flex-start !important; height: 100% !important;}</style>",
        "<style>div#button {height: unset !important; max-height: 100% !important; margin: 0 !important; color: #BC5205 !important;}</style>",
        "<style>div#button {width: 6em !important; font-size: 0.8em !important; box-sizing: border-box !important!;}</style>",
        "<style>div#button {border: 1px solid transparent; border-radius: 0.5em; padding: 0.5em;}</style>",
        "<style>div#button img {width: 3em !important; height: 3em !important;}</style>",
        "<style>div#button span {font-size: smaller !important; height: -webkit-fill-available;}</style>",
        "<style>div#button:hover {border: 1px dashed #BC5205 !important;}</style>"
    ],

    "clickrow_javascript": [
        "const data = arguments[0]; APP_CONSTANTS.ENV._projects_form_data = data;"
    ],

    "load_javascript": [
        "const ruleset_name = APP_CONSTANTS.ENV._firewallruleset_form_data.name",
        "const firewallRuleset = await $$.libapimanager.rest(APP_CONSTANTS.API_KLOUDUSTCMD, 'POST', {",
        "cmd: `getFirewallRuleset ${ruleset_name}`, ", "project: $$.libsession.get(APP_CONSTANTS.ACTIVE_PROJECT)}, true);",
        "for(const ruleset of firewallRuleset.ruleset||[]) {ruleset.allow = ruleset.allow==='true'?'Allow':'Deny';}",
        "return {keys: ['direction','allow','protocol','ip','port'], table: firewallRuleset.ruleset||[]};"
    ]
}
}
